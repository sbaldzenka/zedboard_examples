// project : zedboard uart
// date    : 18.12.2025
// author  : siarhei baldzenka
// e-mail  : venera.electronica@gmail.com

#include <stdio.h>
#include "platform.h"
#include "xil_printf.h"
#include "xparameters.h"
#include "xgpio.h"
#include "xuartlite.h"

#define GPIO_0_ID          XPAR_GPIO_0_DEVICE_ID
#define GPIO_LED_CHANNEL   1
#define UARTLITE_0_ID      XPAR_AXI_UARTLITE_0_DEVICE_ID
#define UART_BUFFER_LENGHT 16

XGpio gpio_0;
XUartLite uartlite_0;

u32 status;
u32 counter;

u8 uart_rx_buffer[UART_BUFFER_LENGHT];

int main()
{
    init_platform();

    status = XGpio_Initialize(&gpio_0, GPIO_0_ID);
    xil_printf("This is ZedBoard!\n\r");

    while (1)
    {
        XGpio_DiscreteWrite(&gpio_0, GPIO_LED_CHANNEL, 0xAA);

        for (counter = 0; counter < 10000000; counter ++);

        XGpio_DiscreteWrite(&gpio_0, GPIO_LED_CHANNEL, 0x55);

        for (counter = 0; counter < 10000000; counter ++);

        xil_printf("Piy-Piy!!!\n\r");
    }

    cleanup_platform();
    return 0;
}
